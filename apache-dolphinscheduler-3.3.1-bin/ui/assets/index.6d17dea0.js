import{d as g,bb as N,b9 as _,ba as W,E as y,r as f,u as F,bI as D,o as R,H as S,I as v,c as t,h as d,bs as O}from"./index.02a17cf1.js";import{u as m}from"./index.9b0cc109.js";import{a as j,b as L,c as x}from"./index.b889db2d.js";import{C as B}from"./index.ef447d1d.js";import z from"./Graph.090f26ed.js";import{R as V}from"./index.bfc434f6.js";import{R as E}from"./ReloadOutlined.809168a4.js";import{N as p}from"./Tooltip.76a430fa.js";import{N as I}from"./Space.8a344b95.js";import{N as q}from"./Select.51d2f90f.js";import{N as k}from"./Button.1b3ea9f7.js";import{N as h}from"./Icon.0cd298dd.js";import"./service.ade35c11.js";import"./ui-setting.7e6814b1.js";import"./lodash.3a74b132.js";import"./Card.f8db533a.js";import"./resolve-slot.92499a18.js";import"./index.5f9a33e7.js";import"./keysOf.843c523b.js";import"./index.8ac5dcc4.js";import"./Popover.92dc7b00.js";import"./index.8a81335d.js";import"./flatten.8ad131a2.js";import"./Scrollbar.988383de.js";import"./VResizeObserver.f80d6e55.js";import"./use-false-until-truthy.e57d8f60.js";import"./_baseMap.d8d47059.js";import"./get.852d0cd9.js";import"./cssr.f561ccf0.js";import"./utils.eff12f29.js";import"./format-length.a6a40b1f.js";import"./use-merged-state.2bdc3563.js";import"./use-compitable.cd47f4ac.js";import"./next-frame-once.50ecadf2.js";import"./is-browser.e7afaa57.js";import"./get-slot.eeb09d52.js";import"./fade-in-scale-up.cssr.d8408fe5.js";import"./use-locale.47aab0f5.js";import"./use-form-item.96cfc8ba.js";import"./Empty.249462a1.js";import"./Suffix.62982c61.js";import"./index.21198e00.js";const M={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},A=W("path",{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 0 0 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3c7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112s112 50.1 112 112s-50.1 112-112 112z",fill:"currentColor"},null,-1),G=[A],H=g({name:"EyeOutlined",render:function(i,a){return N(),_("svg",M,G)}});function T(){const e=y({workflowOptions:[],workflow:f(null),seriesData:[],labelShow:f(!0),links:[]}),i=r=>{e.seriesData=[],e.links=[],e.seriesData=r.data.workFlowRelationDetailList.map(o=>({name:o.workFlowName,id:o.workFlowCode,...o})),e.links=r.data.workFlowRelationList.map(o=>({source:String(o.sourceWorkFlowCode),target:String(o.targetWorkFlowCode)}))};return{variables:e,getWorkflowName:r=>{const{state:o}=m(j({projectCode:r}).then(s=>{e.workflowOptions=s.map(n=>({label:n.workFlowName,value:n.workFlowCode}))}),{});return o},getOneWorkflow:(r,o)=>{const{state:s}=m(L({workFlowCode:r},{projectCode:o}).then(n=>{i(n)}),{});return s},getWorkflowList:r=>{const{state:o}=m(x({projectCode:r}).then(s=>{i(s)}),{});return o}}}const xe=g({name:"workflow-relation",setup(){const{t:e,locale:i}=F(),a=D(),{variables:l,getWorkflowName:c,getOneWorkflow:r,getWorkflowList:o}=T();R(()=>{o(Number(a.params.projectCode)),c(Number(a.params.projectCode))});const s=()=>{l.seriesData=[],l.workflow&&l.workflow!==0?r(Number(l.workflow),Number(a.params.projectCode)):o(Number(a.params.projectCode))},n=({node:w,option:u})=>d(p,null,{trigger:()=>w,default:()=>u.label}),b=(w,u)=>u.label?u.label.toString().toLowerCase().includes(w.toLowerCase()):!1,C=w=>{l.workflow=w};return S(()=>[l.workflow,l.labelShow,i.value],()=>{s()}),{t:e,handleResetDate:s,...v(l),renderOption:n,selectFilter:b,updateValue:C}},render(){const{t:e,handleResetDate:i}=this;return this.seriesData.length===0&&t(V,{title:e("project.workflow.workflow_relation_no_data_result_title"),description:e("project.workflow.workflow_relation_no_data_result_desc"),status:"info",size:"medium"},null)||this.seriesData.length>0&&t(B,{title:e("project.workflow.workflow_relation")},{default:()=>Object.keys(this.seriesData).length>0&&t(z,{seriesData:this.seriesData,labelShow:this.labelShow,links:this.links},null),"header-extra":()=>t(I,null,{default:()=>[d(q,{style:{width:"300px"},clearable:!0,filterable:!0,placeholder:e("project.workflow.workflow_name"),options:O(this.workflowOptions),value:this.workflow,filter:this.selectFilter,onUpdateValue:a=>{this.updateValue(a)}}),t(p,{trigger:"hover"},{default:()=>e("project.workflow.refresh"),trigger:()=>t(k,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:i},{default:()=>[t(h,null,{default:()=>[t(E,null,null)]})]})}),t(p,{trigger:"hover"},{default:()=>e("project.workflow.show_hide_label"),trigger:()=>t(k,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:()=>this.labelShow=!this.labelShow},{default:()=>[t(h,null,{default:()=>[t(H,null,null)]})]})})]})})}});export{xe as default};
