import{u as v,r as p,o as g,bH as R,E as k,d as S,c as n,J as q,L as O,i as x}from"./index.02a17cf1.js";import{g as C,F as E}from"./get-elements-by-json.9f02e085.js";import{u as T,a as F,b as G,c as L,d as U}from"./index.module.a7688846.js";import"./service.ade35c11.js";import"./task-type.618fb0da.js";import"./lodash.3a74b132.js";import{q as D,u as V,a as _}from"./index.1f780a3d.js";import{w as I}from"./common.a16f92ec.js";import{q as A}from"./index.0bedecf2.js";import{l as B}from"./index.124d1fef.js";import{N as J}from"./Switch.a01ace9e.js";import{N as j}from"./Divider.987d98e5.js";import{N as M}from"./Space.8a344b95.js";import{N as W}from"./Button.1b3ea9f7.js";import"./Form.de76c832.js";import"./FormItem.aeb1ee46.js";import"./use-form-item.96cfc8ba.js";import"./format-length.a6a40b1f.js";import"./get.852d0cd9.js";import"./resolve-slot.92499a18.js";import"./keysOf.843c523b.js";import"./Grid.1918be0a.js";import"./index.5f9a33e7.js";import"./utils.eff12f29.js";import"./is-browser.e7afaa57.js";import"./VResizeObserver.f80d6e55.js";import"./flatten.8ad131a2.js";import"./get-slot.eeb09d52.js";import"./next-frame-once.50ecadf2.js";import"./Spin.4db05d4b.js";import"./Scrollbar.988383de.js";import"./use-compitable.cd47f4ac.js";import"./Input.59461546.js";import"./use-locale.47aab0f5.js";import"./use-merged-state.2bdc3563.js";import"./Suffix.62982c61.js";import"./Radio.4578e023.js";import"./RadioGroup.7b709552.js";import"./index.7b2dcdb8.js";import"./DeleteOutlined.d3b97bbb.js";import"./index.8a81335d.js";import"./use-false-until-truthy.e57d8f60.js";import"./InputNumber.cad532d0.js";import"./Add.a9b5dac9.js";import"./Select.51d2f90f.js";import"./fade-in-scale-up.cssr.d8408fe5.js";import"./cssr.f561ccf0.js";import"./Popover.92dc7b00.js";import"./_baseMap.d8d47059.js";import"./Empty.249462a1.js";import"./index.21198e00.js";import"./Checkbox.c8f5c3b1.js";import"./ArrowUpOutlined.5d908421.js";import"./Icon.0cd298dd.js";import"./index.7552dd4e.js";import"./index.e3e49908.js";import"./ui-setting.7e6814b1.js";import"./SettingOutlined.901415e1.js";import"./PauseCircleOutlined.6f50ffc5.js";import"./CloseCircleOutlined.d6e82e31.js";import"./CheckCircleOutlined.b15d9580.js";import"./EditOutlined.8be88705.js";import"./index.8474b6bf.js";function z(){const{t}=v(),r=[];return(()=>{I.forEach(a=>{r.push({label:t(a.code),value:a.id})})})(),{type:"select",field:"warningType",name:t("project.workflow.notification_strategy"),span:12,options:r,validate:{required:!0},value:"NONE"}}function $(){const{t}=v(),r=p([]),s=async()=>{const a=await A();r.value=a.map(o=>({label:o.tenantCode,value:o.tenantCode}))};return g(()=>{s()}),{type:"select",field:"tenant",span:12,name:t("project.workflow.tenant_code"),options:r}}function H(){const{t}=v(),r=p([]),s=async()=>{const a=await B();r.value=a.map(o=>({label:o.groupName,value:o.id}))};return g(()=>{s()}),{type:"select",field:"alertGroups",span:12,name:t("project.workflow.alarm_group"),options:r}}function Q(){const t=R(),{t:r}=v(),s=Number(t.currentRoute.value.params.projectCode),a=p(),o=p([]),u=p([]),l=p({}),f=p({}),d=p(0);f.value={labelPlacement:"left",labelWidth:"auto",size:"large"};const i=k({model:{taskPriority:"MEDIUM",workerGroup:"default",environmentCode:null,failRetryTimes:0,failRetryInterval:1,cpuQuota:-1,memoryMax:-1,timeoutFlag:!1,timeoutNotifyStrategy:["WARN"],timeout:30}}),y=e=>{Object.assign(i.model,e)},w=async()=>{if(s){const e=await D(s);e!=null&&e.preferences&&(y(JSON.parse(e.preferences)),d.value=e.state)}};g(()=>{w()});const b=()=>{const e={projectPreferences:JSON.stringify(i.model)};V(e,s).then(()=>{window.$message.success(r("project.preference.success"))})},N=e=>{_({state:e},s).then(()=>{window.$message.success(r("project.preference.success"))})},h=[T(),$(),F(s),G(i.model,!0),...L(),z(),H(),...U()],P=e=>{var c;for(const m of e)(c=m.validate)!=null&&c.required&&(m.validate.required=!1,m.span=12),m.type==="select"?Object.assign(m,{props:{style:"width: 250px",clearable:!0}}):Object.assign(m,{props:{style:"width: 250px"}});return e};return o.value=P(h),(()=>{const{rules:e,elements:c}=C(o.value,i.model);u.value=c,l.value=e})(),{formRef:a,elementsRef:u,rulesRef:l,model:i.model,stateRef:d,formProps:f,t:r,handleUpdate:b,handleUpdateState:N}}function K(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!x(t)}const it=S({name:"PreferenceForm",setup(){const{formRef:t,elementsRef:r,rulesRef:s,model:a,stateRef:o,formProps:u,t:l,handleUpdate:f,handleUpdateState:d}=Q();return()=>{let i;return n("div",null,[n("div",{style:{marginLeft:"30px"}},[n(J,{size:"large",round:!1,value:o.value,"onUpdate:value":y=>o.value=y,checkedValue:1,uncheckedValue:0,onUpdateValue:d},{checked:()=>l("project.preference.enabled"),unchecked:()=>l("project.preference.disabled")})]),n("div",null,[n("div",{style:{margin:"30px"}},[l("project.preference.instruction_tips")]),n(j,null,null),n(E,{ref:t,meta:{model:a,disabled:o.value!==1,rules:s.value,elements:r.value,...u.value},layout:{xGap:10},style:{marginLeft:"150px"}},null),n(j,null,null),n(M,{justify:"center"},{default:()=>[q(n(W,{type:"info",onClick:f},K(i=l("project.preference.submit"))?i:{default:()=>[i]}),[[O,o.value]])]})])])}}});export{it as default};
