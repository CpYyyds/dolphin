import{M as p}from"./index.08dd828f.js";import{u as q,E as h,r as i,d as y,G as N,H as d,I as v,c as o}from"./index.02a17cf1.js";import{v as w,c as M,u as _}from"./index.a4fa9a03.js";import{N as g}from"./Form.de76c832.js";import{N as c}from"./FormItem.aeb1ee46.js";import{N as f}from"./Input.59461546.js";import"./index.fe057c74.js";import"./Button.1b3ea9f7.js";import"./is-browser.e7afaa57.js";import"./use-form-item.96cfc8ba.js";import"./resolve-slot.92499a18.js";import"./Modal.920fa101.js";import"./keysOf.843c523b.js";import"./Card.f8db533a.js";import"./index.5f9a33e7.js";import"./index.8a81335d.js";import"./flatten.8ad131a2.js";import"./Scrollbar.988383de.js";import"./VResizeObserver.f80d6e55.js";import"./use-false-until-truthy.e57d8f60.js";import"./fade-in-scale-up.cssr.d8408fe5.js";import"./utils.eff12f29.js";import"./index.21198e00.js";import"./Space.8a344b95.js";import"./get-slot.eeb09d52.js";import"./service.ade35c11.js";import"./ui-setting.7e6814b1.js";import"./lodash.3a74b132.js";import"./format-length.a6a40b1f.js";import"./get.852d0cd9.js";import"./use-locale.47aab0f5.js";import"./use-merged-state.2bdc3563.js";import"./Suffix.62982c61.js";function R(e,a){const{t}=q(),u=h({yarnQueueFormRef:i(),model:{id:i(-1),queue:i(""),queueName:i("")},saving:!1,rules:{queue:{required:!0,trigger:["input","blur"],validator(){if(u.model.queue==="")return new Error(t("security.yarn_queue.queue_value_tips"))}},queueName:{required:!0,trigger:["input","blur"],validator(){if(u.model.queueName==="")return new Error(t("security.yarn_queue.queue_name_tips"))}}}}),l=async r=>{if(await u.yarnQueueFormRef.validate(),!u.saving){u.saving=!0;try{r===0?await m():await n(),u.saving=!1}catch{u.saving=!1}}},m=()=>{w({...u.model}).then(()=>{M({...u.model}).then(()=>{u.model.queue="",u.model.queueName="",a.emit("confirmModal",e.showModalRef)})})},n=()=>{_({...u.model},{id:u.model.id}).then(r=>{a.emit("confirmModal",e.showModalRef)})};return{variables:u,handleValidate:l}}const oe=y({name:"YarnQueueModal",props:{showModalRef:{type:Boolean,default:!1},statusRef:{type:Number,default:0},row:{type:Object,default:{}}},emits:["cancelModal","confirmModal"],setup(e,a){var s;const{variables:t,handleValidate:u}=R(e,a),{t:l}=q(),m=()=>{e.statusRef===0&&(t.model.queue="",t.model.queueName=""),a.emit("cancelModal",e.showModalRef)},n=()=>{u(e.statusRef)},r=(s=N())==null?void 0:s.appContext.config.globalProperties.trim;return d(()=>e.statusRef,()=>{e.statusRef===0?(t.model.queue="",t.model.queueName=""):(t.model.id=e.row.id,t.model.queue=e.row.queue,t.model.queueName=e.row.queueName)}),d(()=>e.row,()=>{t.model.id=e.row.id,t.model.queue=e.row.queue,t.model.queueName=e.row.queueName}),{t:l,...v(t),cancelModal:m,confirmModal:n,trim:r}},render(){const{t:e}=this;return o("div",null,[o(p,{title:this.statusRef===0?e("security.yarn_queue.create_queue"):e("security.yarn_queue.edit_queue"),show:this.showModalRef,onCancel:this.cancelModal,onConfirm:this.confirmModal,confirmDisabled:!this.model.queueName||!this.model.queue,confirmClassName:"btn-submit",cancelClassName:"btn-cancel",confirmLoading:this.saving},{default:()=>o(g,{model:this.model,rules:this.rules,ref:"yarnQueueFormRef"},{default:()=>[o(c,{label:e("security.yarn_queue.queue_name"),path:"queueName"},{default:()=>[o(f,{allowInput:this.trim,class:"input-queue-name",placeholder:e("security.yarn_queue.queue_name_tips"),value:this.model.queueName,"onUpdate:value":a=>this.model.queueName=a},null)]}),o(c,{label:e("security.yarn_queue.queue_value"),path:"queue"},{default:()=>[o(f,{allowInput:this.trim,class:"input-queue-value",placeholder:e("security.yarn_queue.queue_value_tips"),value:this.model.queue,"onUpdate:value":a=>this.model.queue=a},null)]})]})})])}});export{oe as default};
