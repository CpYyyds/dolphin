import{u as w,E as R,r as f,d as b,o as L,H,I as h,c as l}from"./index.02a17cf1.js";import{u as y}from"./index.9b0cc109.js";import{l as p}from"./lodash.3a74b132.js";import{a as M,b as T}from"./index.b5f8acb4.js";import{k as u}from"./index.8474b6bf.js";import S from"./state-card.a50ce5d0.js";import x from"./definition-card.c0569f8c.js";import{g as V}from"./DatePicker.d4b2a484.js";import{s as W}from"./index.b7e4ecb8.js";import{N as g,a as k}from"./Grid.1918be0a.js";import"./service.ade35c11.js";import"./ui-setting.7e6814b1.js";import"./Pie.39703b46.js";import"./index.8ac5dcc4.js";import"./index.ef447d1d.js";import"./Card.f8db533a.js";import"./resolve-slot.92499a18.js";import"./index.5f9a33e7.js";import"./keysOf.843c523b.js";import"./DataTable.ddc5a79d.js";import"./ArrowDown.fd6213c2.js";import"./format-length.a6a40b1f.js";import"./Button.1b3ea9f7.js";import"./is-browser.e7afaa57.js";import"./use-form-item.96cfc8ba.js";import"./Scrollbar.988383de.js";import"./VResizeObserver.f80d6e55.js";import"./Checkbox.c8f5c3b1.js";import"./use-merged-state.2bdc3563.js";import"./RadioGroup.7b709552.js";import"./flatten.8ad131a2.js";import"./get-slot.eeb09d52.js";import"./Radio.4578e023.js";import"./Popover.92dc7b00.js";import"./index.8a81335d.js";import"./use-false-until-truthy.e57d8f60.js";import"./_baseMap.d8d47059.js";import"./get.852d0cd9.js";import"./cssr.f561ccf0.js";import"./utils.eff12f29.js";import"./use-compitable.cd47f4ac.js";import"./next-frame-once.50ecadf2.js";import"./Suffix.62982c61.js";import"./Dropdown.de4044d8.js";import"./Icon.0cd298dd.js";import"./ChevronRight.d1d16011.js";import"./Select.51d2f90f.js";import"./fade-in-scale-up.cssr.d8408fe5.js";import"./use-locale.47aab0f5.js";import"./Empty.249462a1.js";import"./index.21198e00.js";import"./use-keyboard.8f9f6db8.js";import"./Ellipsis.eed9f363.js";import"./Tooltip.76a430fa.js";import"./Input.59461546.js";import"./Forward.b8f2636c.js";import"./typeof.481ce13f.js";import"./Bar.5119cff7.js";function C(){const{t:r}=w(),o=R({taskLoadingRef:f(!1)});return{getTaskState:t=>{if(o.taskLoadingRef)return;o.taskLoadingRef=!0;const{state:n}=y(M({startDate:t?u(t[0],"yyyy-MM-dd HH:mm:ss"):"",endDate:t?u(t[1],"yyyy-MM-dd HH:mm:ss"):""}).then(i=>{const s=i.taskInstanceStatusCounts.map((a,c)=>({state:r("home."+p.exports.toLower(a.state)),number:a.count})),e=i.taskInstanceStatusCounts.map(a=>({value:a.count,name:r("home."+p.exports.toLower(a.state))}));return o.taskLoadingRef=!1,{table:s,chart:e}}),{table:[],chart:[]});return n},taskVariables:o}}function I(){const{t:r}=w(),o=R({workflowLoadingRef:f(!1)});return{getWorkflowState:t=>{if(o.workflowLoadingRef)return;o.workflowLoadingRef=!0;const{state:n}=y(T({startDate:t?u(t[0],"yyyy-MM-dd HH:mm:ss"):"",endDate:t?u(t[1],"yyyy-MM-dd HH:mm:ss"):""}).then(i=>{const s=i.workflowInstanceStatusCounts.map(a=>({state:r("home."+p.exports.toLower(a.state)),number:a.count})),e=i.workflowInstanceStatusCounts.map(a=>({value:a.count,name:r("home."+p.exports.toLower(a.state))}));return o.workflowLoadingRef=!1,{table:s,chart:e}}),{table:[],chart:[]});return n},workflowVariables:o}}const Ut=b({name:"home",setup(){const{t:r,locale:o}=w(),m=f([V(W()),Date.now()]),t=f(),n=f(),{getTaskState:i,taskVariables:s}=C(),{getWorkflowState:e,workflowVariables:a}=I(),c=()=>{t.value=i(m.value)||t.value,n.value=e(m.value)||n.value},D=d=>{t.value=i(d)},v=d=>{n.value=e(d)};return L(()=>{c()}),H(()=>o.value,()=>c()),{t:r,dateRef:m,handleTaskDate:D,handleWorkflowDate:v,taskStateRef:t,workflowStateRef:n,...h(s),...h(a)}},render(){const{t:r,dateRef:o,handleTaskDate:m,handleWorkflowDate:t,taskLoadingRef:n,workflowLoadingRef:i}=this;return l("div",null,[l(g,{"x-gap":12,cols:2},{default:()=>[l(k,null,{default:()=>{var s,e;return[l(S,{title:r("home.task_state_statistics"),date:o,tableData:(s=this.taskStateRef)==null?void 0:s.value.table,chartData:(e=this.taskStateRef)==null?void 0:e.value.chart,onUpdateDatePickerValue:m,loadingRef:n},null)]}}),l(k,null,{default:()=>{var s,e;return[l(S,{title:r("home.workflow_state_statistics"),date:o,tableData:(s=this.workflowStateRef)==null?void 0:s.value.table,chartData:(e=this.workflowStateRef)==null?void 0:e.value.chart,onUpdateDatePickerValue:t,loadingRef:i},null)]}})]}),l(g,{cols:1,style:"margin-top: 12px;"},{default:()=>[l(k,null,{default:()=>[l(x,{title:r("home.workflow_definition_statistics")},null)]})]})])}});export{Ut as default};
