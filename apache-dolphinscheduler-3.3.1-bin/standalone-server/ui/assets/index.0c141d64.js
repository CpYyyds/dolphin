import{u as M,h as r,E as O,r as p,d as j,G as I,o as V,H as W,I as x,c as a,i as R}from"./index.02a17cf1.js";import U from"./json-highlight.37f4e240.js";import{B}from"./index.fe057c74.js";import{C as u,c as E,D}from"./column-width-config.03ebcd18.js";import{N as H}from"./Popover.92dc7b00.js";import{N as b}from"./Tooltip.76a430fa.js";import{N as T}from"./Icon.0cd298dd.js";import{E as q}from"./EditOutlined.8be88705.js";import{N as G}from"./Popconfirm.98866df0.js";import{D as F}from"./DeleteOutlined.d3b97bbb.js";import{N as y}from"./Button.1b3ea9f7.js";import{N as d}from"./Space.8a344b95.js";import{d as J,b as Q}from"./index.2cf2fa64.js";import{C as P}from"./index.ef447d1d.js";import{S as X}from"./index.0da29625.js";import Y from"./detail.169eec1d.js";import A from"./source-modal.30872bff.js";import{S as K}from"./SearchOutlined.280f9205.js";import{N as Z,a as $}from"./DataTable.ddc5a79d.js";import"./lodash.3a74b132.js";import"./text.856015a6.js";import"./use-compitable.cd47f4ac.js";import"./index.8a81335d.js";import"./flatten.8ad131a2.js";import"./Scrollbar.988383de.js";import"./VResizeObserver.f80d6e55.js";import"./use-false-until-truthy.e57d8f60.js";import"./_baseMap.d8d47059.js";import"./get.852d0cd9.js";import"./cssr.f561ccf0.js";import"./utils.eff12f29.js";import"./format-length.a6a40b1f.js";import"./resolve-slot.92499a18.js";import"./use-merged-state.2bdc3563.js";import"./next-frame-once.50ecadf2.js";import"./use-locale.47aab0f5.js";import"./keysOf.843c523b.js";import"./is-browser.e7afaa57.js";import"./use-form-item.96cfc8ba.js";import"./get-slot.eeb09d52.js";import"./index.5f9a33e7.js";import"./service.ade35c11.js";import"./ui-setting.7e6814b1.js";import"./Card.f8db533a.js";import"./Input.59461546.js";import"./Suffix.62982c61.js";import"./index.08dd828f.js";import"./Modal.920fa101.js";import"./fade-in-scale-up.cssr.d8408fe5.js";import"./index.21198e00.js";import"./index.module.ff725d2f.js";import"./Spin.4db05d4b.js";import"./Form.de76c832.js";import"./FormItem.aeb1ee46.js";import"./InputNumber.cad532d0.js";import"./Add.a9b5dac9.js";import"./Select.51d2f90f.js";import"./Empty.249462a1.js";import"./RadioGroup.7b709552.js";import"./Radio.4578e023.js";import"./ArrowDown.fd6213c2.js";import"./Checkbox.c8f5c3b1.js";import"./Dropdown.de4044d8.js";import"./ChevronRight.d1d16011.js";import"./use-keyboard.8f9f6db8.js";import"./Ellipsis.eed9f363.js";import"./Forward.b8f2636c.js";function ee(e){const{t}=M();return{getColumns:()=>{const s=[{title:"id",key:"id",...u.index},{title:t("datasource.datasource_name"),key:"name",...u.name},{title:t("datasource.datasource_user_name"),key:"userName",...u.userName},{title:t("datasource.datasource_type"),key:"type",width:180},{title:t("datasource.datasource_parameter"),key:"parameter",width:180,render:o=>r(H,{trigger:"click"},{trigger:()=>r(B,null,{default:()=>t("datasource.click_to_view")}),default:()=>r(U,{rowData:o})})},{title:t("datasource.description"),key:"note",...u.note,render:o=>o.note||"-"},{title:t("datasource.create_time"),key:"createTime",...u.time},{title:t("datasource.update_time"),key:"updateTime",...u.time},{title:t("datasource.operation"),key:"operation",...u.operation(2),render:o=>r(d,null,{default:()=>[r(b,null,{trigger:()=>r(y,{circle:!0,type:"info",size:"small",onClick:()=>void e(o.id,"edit",o)},{default:()=>r(T,null,{default:()=>r(q)})}),default:()=>t("datasource.edit")}),r(b,null,{trigger:()=>r(G,{onPositiveClick:()=>void e(o.id,"delete"),negativeText:t("datasource.cancel"),positiveText:t("datasource.confirm")},{trigger:()=>r(y,{circle:!0,type:"error",size:"small",class:"btn-delete"},{default:()=>r(T,null,{default:()=>r(F)})}),default:()=>t("datasource.delete_confirm")}),default:()=>t("datasource.delete")})]})}];return{columns:s,tableWidth:E(s)||D}}}}function te(){const e=O({page:1,pageSize:10,itemCount:0,searchVal:p(""),list:[],loading:!1}),t=async()=>{if(e.loading)return;e.loading=!0;const i=await Q({pageNo:e.page,pageSize:e.pageSize,searchVal:e.searchVal});e.loading=!1,e.list=i.totalList,e.itemCount=i.total},l=()=>{e.list.length===1&&e.page>1&&--e.page,t()};return{data:e,changePage:i=>{e.page=i,t()},changePageSize:i=>{e.page=1,e.pageSize=i,t()},deleteRecord:async i=>{await J(i),l()},updateList:l}}function ae(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!R(e)}const ht=j({name:"list",setup(){var h;const{t:e}=M(),t=p(!1),l=p(!1),s=p("MYSQL"),o=p(),n=p({columns:[],tableWidth:D}),{data:i,changePage:f,changePageSize:S,deleteRecord:v,updateList:C}=te(),{getColumns:g}=ee((c,w,L)=>{w==="edit"?(t.value=!0,o.value=c,s.value=L.type):v(c)}),N=()=>{o.value=null,l.value=!0},k=(h=I())==null?void 0:h.appContext.config.globalProperties.trim,m=c=>{s.value=c,l.value=!1,t.value=!0},z=()=>{l.value=!0},_=()=>{l.value=!1};return V(()=>{f(1),n.value=g()}),W(M().locale,()=>{n.value=g()}),{t:e,showDetailModal:t,showSourceModal:l,id:o,columns:n,...x(i),changePage:f,changePageSize:S,onCreate:N,onUpdatedList:C,trim:k,handleSelectSourceType:m,selectType:s,handleSourceModalOpen:z,handleSourceModalClose:_}},render(){let e;const{t,id:l,showDetailModal:s,showSourceModal:o,columns:n,list:i,page:f,pageSize:S,itemCount:v,loading:C,changePage:g,changePageSize:N,onCreate:k,onUpdatedList:m,handleSelectSourceType:z,selectType:_,handleSourceModalOpen:h,handleSourceModalClose:c}=this;return a(d,{vertical:!0},{default:()=>[a(P,null,{default:()=>[a(d,{justify:"space-between"},{default:()=>[a(y,{onClick:k,type:"primary",size:"small",class:"btn-create-data-source"},ae(e=t("datasource.create_datasource"))?e:{default:()=>[e]}),a(d,{justify:"end",wrap:!1},{default:()=>[a(X,{value:this.searchVal,"onUpdate:value":w=>this.searchVal=w,placeholder:t("datasource.search_input_tips"),onSearch:m},null),a(y,{type:"primary",size:"small",onClick:m},{default:()=>[a(T,null,{default:()=>[a(K,null,null)]})]})]})]})]}),a(P,{title:t("menu.datasource")},{default:()=>[a(d,{vertical:!0},{default:()=>[a(Z,{"row-class-name":"data-source-items",columns:n.columns,data:i,loading:C,striped:!0,scrollX:n.tableWidth},null),a(d,{justify:"center"},{default:()=>[a($,{page:f,"page-size":S,"item-count":v,"show-quick-jumper":!0,"show-size-picker":!0,"page-sizes":[10,30,50],"on-update:page":g,"on-update:page-size":N},null)]})]})]}),a(A,{show:o,onChange:z,onMaskClick:c},null),a(Y,{show:s,id:l,selectType:_,onCancel:()=>void(this.showDetailModal=!1),onUpdate:m,onOpen:h},null)]})}});export{ht as default};
