import{M as h}from"./index.08dd828f.js";import{u as P,bH as T,E as N,r as l,d as y,G as M,H as u,I as w,c as o}from"./index.02a17cf1.js";import{s as d}from"./service.ade35c11.js";import{N as v}from"./Form.de76c832.js";import{N as j}from"./FormItem.aeb1ee46.js";import{N as f}from"./Input.59461546.js";import{N as D}from"./Select.51d2f90f.js";function B(e,a){return d({url:`/projects/${a}/project-parameter`,method:"get",params:e})}function R(e,a){return d({url:`/projects/${a}/project-parameter`,method:"post",data:e})}function V(e,a){return d({url:`/projects/${a}/project-parameter/${e.code}`,method:"put",data:e})}function U(e,a){return d({url:`/projects/${a}/project-parameter/delete`,method:"post",data:e})}const b={VARCHAR:{alias:"VARCHAR"},INTEGER:{alias:"INTEGER"},LONG:{alias:"LONG"},FLOAT:{alias:"FLOAT"},DOUBLE:{alias:"DOUBLE"},DATE:{alias:"DATE"},TIME:{alias:"TIME"},TIMESTAMP:{alias:"TIMESTAMP"},BOOLEAN:{alias:"BOOLEAN"},LIST:{alias:"LIST"},FILE:{alias:"FILE"}},c="VARCHAR";function E(e,a){const{t}=P(),p=T(),r=N({formRef:l(),projectCode:l(Number(p.currentRoute.value.params.projectCode)),model:{code:l(-1),projectParameterName:l(""),projectParameterValue:l(""),projectParameterDataType:l(c)},saving:!1,rules:{name:{required:!0,trigger:["input","blur"],validator(){if(r.model.projectParameterName==="")return new Error(t("project.parameter.name_tips"))}},value:{required:!0,trigger:["input","blur"],validator(){if(r.model.projectParameterValue==="")return new Error(t("project.parameter.value_tips"))}},data_type:{required:!0,trigger:["input","blur"],validator(){if(r.model.projectParameterDataType==="")return new Error(t("project.parameter.data_type_tips"))}}}}),s=async m=>{if(!r.saving){r.saving=!0;try{m===0?await i():await n(),r.saving=!1}catch{r.saving=!1}}},i=()=>{const m={projectParameterName:r.model.projectParameterName,projectParameterValue:r.model.projectParameterValue,projectParameterDataType:r.model.projectParameterDataType};R(m,r.projectCode).then(()=>{r.model.projectParameterName="",r.model.projectParameterValue="",r.model.projectParameterDataType=c,a.emit("confirmModal",e.showModalRef)})},n=()=>{const m={code:r.model.code,projectParameterName:r.model.projectParameterName,projectParameterValue:r.model.projectParameterValue,projectParameterDataType:r.model.projectParameterDataType};V(m,r.projectCode).then(()=>{a.emit("confirmModal",e.showModalRef)})};return{variables:r,handleValidate:s}}const g=y({name:"ParameterModal",props:{showModalRef:{type:Boolean,default:!1},statusRef:{type:Number,default:0},row:{type:Object,default:{}}},emits:["cancelModal","confirmModal"],setup(e,a){var m;const{variables:t,handleValidate:p}=E(e,a),{t:r}=P(),s=()=>{e.statusRef===0?(t.model.projectParameterName="",t.model.projectParameterValue="",t.model.projectParameterDataType=c):(t.model.projectParameterName=e.row.paramName,t.model.projectParameterValue=e.row.paramValue,t.model.projectParameterDataType=e.row.paramDataType),a.emit("cancelModal",e.showModalRef)},i=()=>{p(e.statusRef)},n=(m=M())==null?void 0:m.appContext.config.globalProperties.trim;return u(()=>e.showModalRef,()=>{e.showModalRef}),u(()=>e.statusRef,()=>{e.statusRef===0?(t.model.projectParameterName="",t.model.projectParameterValue="",t.model.projectParameterDataType=c):(t.model.code=e.row.code,t.model.projectParameterName=e.row.paramName,t.model.projectParameterValue=e.row.paramValue,t.model.projectParameterDataType=e.row.paramDataType)}),u(()=>e.row,()=>{t.model.code=e.row.code,t.model.projectParameterName=e.row.paramName,t.model.projectParameterValue=e.row.paramValue,t.model.projectParameterDataType=e.row.paramDataType}),{t:r,...w(t),cancelModal:s,confirmModal:i,trim:n}},render(){const{t:e}=this;return o("div",null,[o(h,{title:this.statusRef===0?e("project.parameter.create_parameter"):e("project.parameter.edit_parameter"),show:this.showModalRef,onCancel:this.cancelModal,onConfirm:this.confirmModal,confirmDisabled:!this.model.projectParameterName||!this.model.projectParameterValue||!this.model.projectParameterDataType,confirmClassName:"btn-submit",cancelClassName:"btn-cancel",confirmLoading:this.saving},{default:()=>o(v,{model:this.model,rules:this.rules,ref:"formRef"},{default:()=>[o(j,{label:e("project.parameter.name"),path:"name"},{default:()=>[o(f,{allowInput:this.trim,placeholder:e("project.parameter.name_tips"),value:this.model.projectParameterName,"onUpdate:value":a=>this.model.projectParameterName=a},null)]}),o(j,{label:e("project.parameter.value"),path:"value"},{default:()=>[o(f,{allowInput:this.trim,placeholder:e("project.parameter.value_tips"),value:this.model.projectParameterValue,"onUpdate:value":a=>this.model.projectParameterValue=a},null)]}),o(j,{label:e("project.parameter.data_type"),path:"data_type"},{default:()=>[o(D,{placeholder:e("project.parameter.data_type_tips"),options:Object.keys(b).map(a=>({value:a,label:a})),value:this.model.projectParameterDataType,"onUpdate:value":a=>this.model.projectParameterDataType=a},null)]})]})})])}}),q=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));export{b as D,g as P,U as d,q as p,B as q};
