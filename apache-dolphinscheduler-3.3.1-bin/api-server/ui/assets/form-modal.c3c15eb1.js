import{u as g,E as h,r as f,d as D,o as v,G as C,I as j,c as e}from"./index.02a17cf1.js";import{M as k}from"./index.08dd828f.js";import{u as z,c as b}from"./index.a8939d99.js";import{b as N}from"./index.d2c86bbc.js";import{N as S}from"./Form.de76c832.js";import{N as s}from"./FormItem.aeb1ee46.js";import{N as c}from"./Input.59461546.js";import{N as w}from"./Select.51d2f90f.js";import{N as y}from"./InputNumber.cad532d0.js";import"./index.fe057c74.js";import"./Button.1b3ea9f7.js";import"./is-browser.e7afaa57.js";import"./use-form-item.96cfc8ba.js";import"./resolve-slot.92499a18.js";import"./Modal.920fa101.js";import"./keysOf.843c523b.js";import"./Card.f8db533a.js";import"./index.5f9a33e7.js";import"./index.8a81335d.js";import"./flatten.8ad131a2.js";import"./Scrollbar.988383de.js";import"./VResizeObserver.f80d6e55.js";import"./use-false-until-truthy.e57d8f60.js";import"./fade-in-scale-up.cssr.d8408fe5.js";import"./utils.eff12f29.js";import"./index.21198e00.js";import"./Space.8a344b95.js";import"./get-slot.eeb09d52.js";import"./service.ade35c11.js";import"./ui-setting.7e6814b1.js";import"./lodash.3a74b132.js";import"./format-length.a6a40b1f.js";import"./get.852d0cd9.js";import"./use-locale.47aab0f5.js";import"./use-merged-state.2bdc3563.js";import"./Suffix.62982c61.js";import"./use-compitable.cd47f4ac.js";import"./cssr.f561ccf0.js";import"./Popover.92dc7b00.js";import"./_baseMap.d8d47059.js";import"./next-frame-once.50ecadf2.js";import"./Empty.249462a1.js";import"./Add.a9b5dac9.js";function I(){const{t}=g(),r=h({formRef:f(),formData:{id:0,name:"",projectCode:null,groupSize:"",status:1,description:""},saving:!1,rules:{name:{required:!0,trigger:["input","blur"],validator(){if(!r.formData.name)return new Error(t("resource.task_group_option.please_enter_name"))}},groupSize:{required:!0,trigger:["input","blur"],validator(){if(!r.formData.groupSize)return new Error(t("resource.task_group_option.please_enter_resource_pool_size"));if(!/^[1-9]\d*$/.test(r.formData.groupSize))return new Error(t("resource.task_group_option.resource_pool_size")+t("resource.task_group_option.positive_integer_tips"))}},projectCode:{required:!0,trigger:["input","blur"],validator(){if(!r.formData.projectCode)return new Error(t("resource.task_group_option.please_select_project"))}}}});return{state:r,t}}const E={show:{type:Boolean,default:!1},data:{type:Object},status:{type:Number,default:0}},Ct=D({name:"FormModal",props:E,emits:["confirm","cancel"],setup(t,{emit:r}){var u;const{state:o,t:p}=I(),i=f([]);v(()=>{N().then(m=>{m.map(l=>{const _={label:l.name,value:l.code};i.value.push(_)})}),t.status===1?(o.formData.id=t.data.id,o.formData.name=t.data.name,o.formData.projectCode=t.data.projectCode,o.formData.groupSize=String(t.data.groupSize),o.formData.status=t.data.status,o.formData.description=t.data.description):o.formData.groupSize="10"});const n=async()=>{if(!o.saving){o.saving=!0;try{t.status===1?await z(o.formData):await b(o.formData),o.saving=!1,r("confirm")}catch{o.saving=!1}}},a=()=>{o.formData.projectCode="",o.formData.description="",r("cancel")},d=(u=C())==null?void 0:u.appContext.config.globalProperties.trim;return{...j(o),t:p,onConfirm:n,onCancel:a,projectOptions:i,trim:d}},render(){const{t,onConfirm:r,onCancel:o,show:p,status:i,projectOptions:n}=this;return e(k,{title:t(i===0?"resource.task_group_option.create":"resource.task_group_option.edit"),show:p,onConfirm:r,onCancel:o,confirmDisabled:!this.formData.name||!this.formData.groupSize||!this.formData.projectCode,confirmLoading:this.saving},{default:()=>[e(S,{rules:this.rules,ref:"formRef"},{default:()=>[e(s,{label:t("resource.task_group_option.name"),path:"name"},{default:()=>[e(c,{allowInput:this.trim,value:this.formData.name,"onUpdate:value":a=>this.formData.name=a,placeholder:t("resource.task_group_option.please_enter_name")},null)]}),this.status===0&&e(s,{label:t("resource.task_group_option.project_name"),path:"projectCode"},{default:()=>[e(w,{options:n,value:this.formData.projectCode,"onUpdate:value":a=>this.formData.projectCode=a,placeholder:t("resource.task_group_option.please_select_project")},null)]}),e(s,{label:t("resource.task_group_option.resource_pool_size"),path:"groupSize"},{default:()=>[e(y,{value:this.formData.groupSize,"onUpdate:value":a=>this.formData.groupSize=a,style:{width:"100%"},min:1,placeholder:t("resource.task_group_option.please_enter_resource_pool_size")},null)]}),e(s,{label:t("resource.task_group_option.desc"),path:"description"},{default:()=>[e(c,{allowInput:this.trim,value:this.formData.description,"onUpdate:value":a=>this.formData.description=a,type:"textarea",placeholder:t("resource.task_group_option.please_enter_desc")},null)]})]})]})}});export{Ct as default};
