import{M as h}from"./index.08dd828f.js";import{u as f,E as w,r as m,d as C,G as v,H as u,I as M,c as r}from"./index.02a17cf1.js";import{v as k,c as g}from"./index.747658f4.js";import{a as N}from"./index.b0b7f313.js";import{u as _}from"./index.9b0cc109.js";import{N as R}from"./Form.de76c832.js";import{N as p}from"./FormItem.aeb1ee46.js";import{N as y}from"./Input.59461546.js";import{N as b}from"./Select.51d2f90f.js";import"./index.fe057c74.js";import"./Button.1b3ea9f7.js";import"./is-browser.e7afaa57.js";import"./use-form-item.96cfc8ba.js";import"./resolve-slot.92499a18.js";import"./Modal.920fa101.js";import"./keysOf.843c523b.js";import"./Card.f8db533a.js";import"./index.5f9a33e7.js";import"./index.8a81335d.js";import"./flatten.8ad131a2.js";import"./Scrollbar.988383de.js";import"./VResizeObserver.f80d6e55.js";import"./use-false-until-truthy.e57d8f60.js";import"./fade-in-scale-up.cssr.d8408fe5.js";import"./utils.eff12f29.js";import"./index.21198e00.js";import"./Space.8a344b95.js";import"./get-slot.eeb09d52.js";import"./service.ade35c11.js";import"./ui-setting.7e6814b1.js";import"./lodash.3a74b132.js";import"./format-length.a6a40b1f.js";import"./get.852d0cd9.js";import"./use-locale.47aab0f5.js";import"./use-merged-state.2bdc3563.js";import"./Suffix.62982c61.js";import"./use-compitable.cd47f4ac.js";import"./cssr.f561ccf0.js";import"./Popover.92dc7b00.js";import"./_baseMap.d8d47059.js";import"./next-frame-once.50ecadf2.js";import"./Empty.249462a1.js";function I(e,s){const{t}=f(),a=w({k8sNamespaceFormRef:m(),model:{id:m(-1),namespace:m(""),clusterCode:m(""),userId:m(""),clusterOptions:[]},saving:!1,rules:{namespace:{required:!0,trigger:["input","blur"],validator(){if(a.model.namespace==="")return new Error(t("security.k8s_namespace.k8s_namespace_tips"))}},clusterCode:{required:!0,trigger:["input","blur"],validator(){if(a.model.clusterCode==="")return new Error(t("security.k8s_namespace.k8s_cluster_tips"))}}}}),d=async l=>{if(await a.k8sNamespaceFormRef.validate(),!a.saving){a.saving=!0;try{l===0&&c(),a.saving=!1}catch{a.saving=!1}}},n=()=>{const{state:l}=_(N().then(i=>{a.model.clusterOptions=i.filter(o=>o.config?!!JSON.parse(o.config).k8s:!1).map(o=>({label:o.name,value:o.code}))}),{});return l},c=()=>{k(a.model).then(()=>{g(a.model).then(()=>{a.model.namespace="",a.model.clusterCode="",a.model.userId="",s.emit("confirmModal",e.showModalRef)})})};return{variables:a,handleValidate:d,getListData:n}}const Ce=C({name:"YarnQueueModal",props:{showModalRef:{type:Boolean,default:!1},statusRef:{type:Number,default:0},row:{type:Object,default:{}}},emits:["cancelModal","confirmModal"],setup(e,s){var o;const{variables:t,handleValidate:a,getListData:d}=I(e,s),{t:n}=f(),c=()=>{e.statusRef===0&&(t.model.namespace="",t.model.clusterCode="",t.model.userId=""),s.emit("cancelModal",e.showModalRef)},l=()=>{a(e.statusRef)},i=(o=v())==null?void 0:o.appContext.config.globalProperties.trim;return u(()=>e.showModalRef,()=>{e.showModalRef&&d()}),u(()=>e.statusRef,()=>{e.statusRef===0?(t.model.namespace="",t.model.clusterCode="",t.model.userId=""):(t.model.id=e.row.id,t.model.namespace=e.row.namespace,t.model.clusterCode=e.row.clusterCode,t.model.userId=e.row.userId)}),u(()=>e.row,()=>{t.model.id=e.row.id,t.model.namespace=e.row.namespace,t.model.clusterCode=e.row.clusterCode,t.model.userId=e.row.userId}),{t:n,...M(t),cancelModal:c,confirmModal:l,trim:i}},render(){const{t:e}=this;return r("div",null,[r(h,{title:e("security.k8s_namespace.create_namespace"),show:this.showModalRef,onCancel:this.cancelModal,onConfirm:this.confirmModal,confirmDisabled:!this.model.namespace||this.model.clusterCode==null||this.model.clusterCode==="",confirmLoading:this.saving},{default:()=>r(R,{model:this.model,rules:this.rules,ref:"k8sNamespaceFormRef"},{default:()=>[r(p,{label:e("security.k8s_namespace.k8s_namespace"),path:"namespace"},{default:()=>[r(y,{allowInput:this.trim,placeholder:e("security.k8s_namespace.k8s_namespace_tips"),value:this.model.namespace,"onUpdate:value":s=>this.model.namespace=s,disabled:this.statusRef!==0},null)]}),r(p,{label:e("security.k8s_namespace.k8s_cluster"),path:"clusterCode"},{default:()=>[r(b,{placeholder:e("security.k8s_namespace.k8s_cluster_tips"),options:this.model.clusterOptions,value:this.model.clusterCode,"onUpdate:value":s=>this.model.clusterCode=s,disabled:this.statusRef!==0},null)]})]})})])}});export{Ce as default};
