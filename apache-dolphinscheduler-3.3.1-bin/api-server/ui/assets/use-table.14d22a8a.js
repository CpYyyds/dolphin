import{u as T,bH as _,D as P,E as k,r as i,h as N}from"./index.02a17cf1.js";import{u as C}from"./index.9b0cc109.js";import{v as z,u as b,c as L}from"./index.b0aa157e.js";import{e as w}from"./common.a16f92ec.js";import D from"./table-action.65f20e21.js";import{B as I}from"./index.fe057c74.js";import{c as F,D as V,C as o}from"./column-width-config.03ebcd18.js";import{N as v}from"./Ellipsis.eed9f363.js";function $(e){const{t:r}=T(),a=_();return{getResourceView:(n,u)=>C(z({skipLineNum:0,limit:-1,fullName:n,tenantCode:u}),{alias:"",content:""}),handleUpdateContent:(n,u)=>{e.fileFormRef.validate(async d=>{d||(await b({...e.fileForm,tenantCode:u,fullName:n}),window.$message.success(r("resource.file.success")),a.go(-1))})}}}const j=P("isDetailPage",{state:()=>({isDetailPage:!1}),getters:{getIsDetailPage(){return this.isDetailPage}},actions:{setIsDetailPage(e){this.isDetailPage=e}}}),J=e=>e===""||e===void 0||e===null;function q(e={}){return{getResourceListState:(f,m="",n="",u="",d=1,y=10)=>{const{state:c}=C(L({fullName:m,tenantCode:n,type:f,searchVal:u,pageNo:d,pageSize:y}).then(g=>{const{total:h}=g;e(h);const s=g.totalList.map(t=>({id:t.id,name:t.alias,alias:t.alias,fullName:t.fullName,type:t.type,user_name:t.userName,directory:t.directory,file_name:t.fileName,size:t.size,create_time:t.createTime,update_time:t.updateTime}));return{total:h,table:s}}),{total:0,table:[]});return c},getResourceView:(f,m)=>{const n={skipLineNum:0,limit:-1,fullName:f,tenantCode:m},{state:u}=C(z(n),{});return u}}}const E=(e,r)=>{r.directory?e.push({name:"resource-file-subdirectory",query:{prefix:r.fullName,tenantCode:r.user_name}}):r.type==="FILE"&&e.push({name:"resource-file-list",query:{prefix:r.fullName,tenantCode:r.user_name}})};function K(){const{t:e}=T(),r=_(),a=k({columns:[],fullName:i(String(r.currentRoute.value.query.prefix||"")),tenantCode:i(String(r.currentRoute.value.query.tenantCode||"")),resourceType:i(),resourceList:i(),folderShowRef:i(!1),uploadShowRef:i(!1),isReupload:i(!1),renameShowRef:i(!1),searchRef:i(),renameInfo:i({name:"",description:"",fullName:"",user_name:""}),reuploadInfo:i({name:"",description:"",fullName:"",user_name:""}),pagination:i({page:1,pageSize:10,itemCount:0,pageSizes:[10,30,50]})}),f=s=>{s.columns=[{title:"#",key:"id",...o.index,render:(t,l)=>l+1},{title:e("resource.file.name"),key:"name",...o.linkName,render:t=>t.directory?N(I,{onClick:()=>E(r,t)},{default:()=>N(v,o.linkEllipsis,()=>t.alias)}):t.alias},{title:e("resource.file.tenant_name"),...o.userName,key:"user_name"},{title:e("resource.file.whether_directory"),key:"whether_directory",...o.yesOrNo,render:t=>t.directory?e("resource.file.yes"):e("resource.file.no")},{title:e("resource.file.file_name"),...o.name,key:"file_name"},{title:e("resource.file.size"),key:"size",...o.size,render:t=>w(t.size)},{title:e("resource.file.create_time"),...o.time,key:"create_time"},{title:e("resource.file.update_time"),...o.time,key:"update_time"},{title:e("resource.file.operation"),key:"operation",render:t=>N(D,{row:t,onReuploadResource:(l,p,R,S)=>n(l,p,R,S),onRenameResource:(l,p,R,S)=>u(l,p,R,S),onUpdateList:()=>h()}),...o.operation(5)}]},m=()=>{const{fullName:s}=a,t=s?"resource-subfile-create":"resource-file-create";r.push({name:t,params:{id:s}})},n=(s,t,l,p)=>{a.reuploadInfo={name:s,description:t,fullName:l,user_name:p},a.isReupload=!0,a.uploadShowRef=!0},u=(s,t,l,p)=>{a.renameInfo={name:s,description:t,fullName:l,user_name:p},a.renameShowRef=!0},d=s=>{a.pagination.itemCount=s},{getResourceListState:y}=q(d),c=x(),g=()=>{a.resourceList=y(a.resourceType,a.fullName,a.tenantCode,a.searchRef,a.pagination.page,a.pagination.pageSize),c.setResourceType(a.resourceType),c.setFullName(a.fullName),c.setTenantCode(a.tenantCode),c.setSearchValue(a.searchRef),c.setPage(a.pagination.page),c.setPageSize(a.pagination.pageSize)},h=()=>{a.pagination.page=1,g()};return{variables:a,tableWidth:F(a.columns)||V,requestData:g,updateList:h,createColumns:f,handleCreateFile:m}}const x=P("detailPage",{state:()=>{let e;return{resourceType:e,fullName:"",tenantCode:"",searchValue:"",page:1,pageSize:10}},getters:{getResourceType(){return this.resourceType},getFullName(){return this.fullName},getTenantCode(){return this.tenantCode},getSearchValue(){return this.searchValue},getPage(){return this.page},getPageSize(){return this.pageSize}},actions:{setResourceType(e){this.resourceType=e},setFullName(e){this.fullName=e},setTenantCode(e){this.tenantCode=e},setSearchValue(e){this.searchValue=e},setPage(e){this.page=e},setPageSize(e){this.pageSize=e}}});export{j as a,$ as b,K as c,J as i,x as u};
