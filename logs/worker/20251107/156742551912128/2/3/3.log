2025-11-07 15:42:14.757 INFO  - üê¨ Initialize Task Context
2025-11-07 15:42:14.808 INFO  - TenantCode: cpy check successfully
2025-11-07 15:42:14.811 INFO  - TaskInstance working directory: /tmp/dolphinscheduler/exec/process/3 create successfully
2025-11-07 15:42:14.835 INFO  - Download resource file /tmp/dolphinscheduler/default/resources/flink-file-wordcount-1.0-SNAPSHOT.jar -> /tmp/dolphinscheduler/exec/process/3/flink-file-wordcount-1.0-SNAPSHOT.jar successfully
2025-11-07 15:42:14.870 INFO  - Download resources successfully: 
ResourceContext(resourceItemMap={/tmp/dolphinscheduler/default/resources/flink-file-wordcount-1.0-SNAPSHOT.jar=ResourceContext.ResourceItem(resourceAbsolutePathInStorage=/tmp/dolphinscheduler/default/resources/flink-file-wordcount-1.0-SNAPSHOT.jar, resourceAbsolutePathInLocal=/tmp/dolphinscheduler/exec/process/3/flink-file-wordcount-1.0-SNAPSHOT.jar)})
2025-11-07 15:42:14.891 INFO  - üê¨ Load Task Instance Plugin
2025-11-07 15:42:14.907 INFO  - Initialized physicalTask: FLINK successfully
2025-11-07 15:42:14.922 INFO  - Initialize flink task params {
  "localParams" : [ ],
  "varPool" : [ ],
  "mainJar" : {
    "id" : null,
    "resourceName" : "/tmp/dolphinscheduler/default/resources/flink-file-wordcount-1.0-SNAPSHOT.jar",
    "res" : null
  },
  "mainClass" : "org.example.HelloWorld",
  "deployMode" : "local",
  "mainArgs" : "--output /tmp/flink/output",
  "slot" : 1,
  "parallelism" : 1,
  "appName" : null,
  "taskManager" : 2,
  "jobManagerMemory" : "1G",
  "taskManagerMemory" : "2G",
  "resourceList" : [ {
    "id" : null,
    "resourceName" : "/tmp/dolphinscheduler/default/resources/flink-file-wordcount-1.0-SNAPSHOT.jar",
    "res" : null
  } ],
  "yarnQueue" : "",
  "others" : null,
  "flinkVersion" : "<1.10",
  "programType" : "JAVA",
  "initScript" : "",
  "rawScript" : ""
}
2025-11-07 15:42:14.971 INFO  - Writing content: set execution.target=local;
set parallelism.default=1;

2025-11-07 15:42:14.972 INFO  - To file: /tmp/dolphinscheduler/exec/process/3/3_init.sql
2025-11-07 15:42:14.975 INFO  - Set taskVarPool: null successfully
2025-11-07 15:42:14.975 INFO  - üê¨ Execute Task Instance
2025-11-07 15:42:15.044 INFO  - Final Script Content:
====================
#!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/usr/local/openjdk-8
export FLINK_HOME=/usr/local/flink
export DOLPHINSCHEDULER_HOME=/opt/dolphinscheduler
export PATH=$JAVA_HOME/bin:$FLINK_HOME/bin:$DOLPHINSCHEDULER_HOME/bin:$PATH
${FLINK_HOME}/bin/flink run -p 1 -sae -c org.example.HelloWorld /tmp/dolphinscheduler/exec/process/3/flink-file-wordcount-1.0-SNAPSHOT.jar --output /tmp/flink/output
====================
2025-11-07 15:42:15.048 INFO  - Executing shell command : sudo -u cpy -i /tmp/dolphinscheduler/exec/process/3/3.sh
2025-11-07 15:42:15.067 INFO  - process start, process id is: 1052
2025-11-07 15:42:17.066 INFO  -  -> 
	2025-11-07 15:42:16,477 main ERROR FileManager (/usr/local/flink/log/flink-cpy-client-dolphinscheduler.log) java.io.FileNotFoundException: /usr/local/flink/log/flink-cpy-client-dolphinscheduler.log (Permission denied) java.io.FileNotFoundException: /usr/local/flink/log/flink-cpy-client-dolphinscheduler.log (Permission denied)
		at java.io.FileOutputStream.open0(Native Method)
		at java.io.FileOutputStream.open(FileOutputStream.java:270)
		at java.io.FileOutputStream.<init>(FileOutputStream.java:213)
		at org.apache.logging.log4j.core.appender.FileManager$FileManagerFactory.createManager(FileManager.java:438)
		at org.apache.logging.log4j.core.appender.FileManager$FileManagerFactory.createManager(FileManager.java:422)
		at org.apache.logging.log4j.core.appender.AbstractManager.getManager(AbstractManager.java:114)
		at org.apache.logging.log4j.core.appender.OutputStreamManager.getManager(OutputStreamManager.java:100)
		at org.apache.logging.log4j.core.appender.FileManager.getFileManager(FileManager.java:182)
		at org.apache.logging.log4j.core.appender.FileAppender$Builder.build(FileAppender.java:96)
		at org.apache.logging.log4j.core.appender.FileAppender$Builder.build(FileAppender.java:52)
		at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:122)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:1120)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1045)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1037)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:651)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:247)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:293)
		at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:626)
		at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:699)
		at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:716)
		at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:270)
		at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:155)
		at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:47)
		at org.apache.logging.log4j.LogManager.getContext(LogManager.java:196)
		at org.apache.logging.log4j.spi.AbstractLoggerAdapter.getContext(AbstractLoggerAdapter.java:137)
		at org.apache.logging.slf4j.Log4jLoggerFactory.getContext(Log4jLoggerFactory.java:55)
		at org.apache.logging.log4j.spi.AbstractLoggerAdapter.getLogger(AbstractLoggerAdapter.java:47)
		at org.apache.logging.slf4j.Log4jLoggerFactory.getLogger(Log4jLoggerFactory.java:33)
		at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:363)
		at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:388)
		at org.apache.flink.client.cli.CliFrontend.<clinit>(CliFrontend.java:93)
	
	2025-11-07 15:42:16,488 main ERROR Could not create plugin of type class org.apache.logging.log4j.core.appender.FileAppender for element FILE: java.lang.IllegalStateException: ManagerFactory [org.apache.logging.log4j.core.appender.FileManager$FileManagerFactory@8e0379d] unable to create manager for [/usr/local/flink/log/flink-cpy-client-dolphinscheduler.log] with data [org.apache.logging.log4j.core.appender.FileManager$FactoryData@341b80b2] java.lang.IllegalStateException: ManagerFactory [org.apache.logging.log4j.core.appender.FileManager$FileManagerFactory@8e0379d] unable to create manager for [/usr/local/flink/log/flink-cpy-client-dolphinscheduler.log] with data [org.apache.logging.log4j.core.appender.FileManager$FactoryData@341b80b2]
		at org.apache.logging.log4j.core.appender.AbstractManager.getManager(AbstractManager.java:116)
		at org.apache.logging.log4j.core.appender.OutputStreamManager.getManager(OutputStreamManager.java:100)
		at org.apache.logging.log4j.core.appender.FileManager.getFileManager(FileManager.java:182)
		at org.apache.logging.log4j.core.appender.FileAppender$Builder.build(FileAppender.java:96)
		at org.apache.logging.log4j.core.appender.FileAppender$Builder.build(FileAppender.java:52)
		at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:122)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:1120)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1045)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1037)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:651)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:247)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:293)
		at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:626)
		at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:699)
		at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:716)
		at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:270)
		at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:155)
		at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:47)
		at org.apache.logging.log4j.LogManager.getContext(LogManager.java:196)
		at org.apache.logging.log4j.spi.AbstractLoggerAdapter.getContext(AbstractLoggerAdapter.java:137)
		at org.apache.logging.slf4j.Log4jLoggerFactory.getContext(Log4jLoggerFactory.java:55)
		at org.apache.logging.log4j.spi.AbstractLoggerAdapter.getLogger(AbstractLoggerAdapter.java:47)
		at org.apache.logging.slf4j.Log4jLoggerFactory.getLogger(Log4jLoggerFactory.java:33)
		at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:363)
		at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:388)
		at org.apache.flink.client.cli.CliFrontend.<clinit>(CliFrontend.java:93)
	
	2025-11-07 15:42:16,489 main ERROR Unable to invoke factory method in class org.apache.logging.log4j.core.appender.FileAppender for element FILE: java.lang.IllegalStateException: No factory method found for class org.apache.logging.log4j.core.appender.FileAppender java.lang.IllegalStateException: No factory method found for class org.apache.logging.log4j.core.appender.FileAppender
		at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.findFactoryMethod(PluginBuilder.java:236)
		at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:134)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:1120)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1045)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1037)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:651)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:247)
		at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:293)
		at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:626)
		at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:699)
		at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:716)
		at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:270)
		at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:155)
		at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:47)
		at org.apache.logging.log4j.LogManager.getContext(LogManager.java:196)
		at org.apache.logging.log4j.spi.AbstractLoggerAdapter.getContext(AbstractLoggerAdapter.java:137)
		at org.apache.logging.slf4j.Log4jLoggerFactory.getContext(Log4jLoggerFactory.java:55)
		at org.apache.logging.log4j.spi.AbstractLoggerAdapter.getLogger(AbstractLoggerAdapter.java:47)
		at org.apache.logging.slf4j.Log4jLoggerFactory.getLogger(Log4jLoggerFactory.java:33)
		at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:363)
		at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:388)
		at org.apache.flink.client.cli.CliFrontend.<clinit>(CliFrontend.java:93)
	
	2025-11-07 15:42:16,490 main ERROR Null object returned for FILE in Appenders.
	2025-11-07 15:42:16,490 main ERROR Unable to locate appender "FileAppender" for logger config "root"
	2025-11-07 15:42:16,490 main ERROR Unable to locate appender "FileAppender" for logger config "org.apache.hadoop.hive"
	‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
	‚ïë   Flink Hello World Á®ãÂ∫èÔºà‰ΩéËµÑÊ∫êÁâàÔºâ          ‚ïë
	‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
	‚ïë  ËæìÂá∫Ë∑ØÂæÑÔºö/tmp/flink/output
	‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
	
2025-11-07 15:42:18.070 INFO  -  -> 
	üìù ÁªìÊûúÂ∞ÜËæìÂá∫Âà∞Êñá‰ª∂Ôºö/tmp/flink/output
	
2025-11-07 15:42:19.072 INFO  -  -> 
	Job has been submitted with JobID ae3d1996e9fa74ec88214888b1dc1f9b
2025-11-07 15:42:21.074 INFO  -  -> 
	Program execution finished
	Job with JobID ae3d1996e9fa74ec88214888b1dc1f9b has finished.
	Job Runtime: 1113 ms
	
	
	‚úÖ ‰ªªÂä°ÊâßË°åÂÆåÊàêÔºÅ
	üìÇ ËØ∑Êü•ÁúãËæìÂá∫ÁõÆÂΩïÔºö/tmp/flink/output
2025-11-07 15:42:21.076 INFO  - process has exited. execute path:/tmp/dolphinscheduler/exec/process/3, processId:1052 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
2025-11-07 15:42:21.077 INFO  - Start finding appId in /opt/dolphinscheduler/worker-server/logs/20251107/156742551912128/2/3/3.log, fetch way: log 
2025-11-07 15:42:21.234 INFO  - üê¨ Finalize Task Instance
2025-11-07 15:42:21.235 INFO  - FINALIZE_SESSION
2025-11-07 15:42:21.251 INFO  - Deleted task exec directory: /tmp/dolphinscheduler/exec/process/3
